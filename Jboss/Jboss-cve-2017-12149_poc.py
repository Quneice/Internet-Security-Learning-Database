# -*- coding: utf-8 -*-


import requests
import sys
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

# url = sys.argv[1]

def exp_check(url):
    vulurl = url + "/invoker/readonly"
    headers = {
        'User-Agent': "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0",
        'Accept': "*/*",
        'Content-Type': "application/json",
        'X-Requested-With': "XMLHttpRequest",
        'Connection': "close",
        'Cache-Control': "no-cache"
    }
    try:
        r = requests.post(vulurl, headers=headers, verify=False)
        e = r.status_code
        if e == 500:
            return 1
        return 2
    except:
        return 3

def exp_cmd(url, cmd):
    # 暂未发现利用方法
    pass
if __name__ == '__main__':
    pass
    # url = sys.argv[1]
    # # cmd=sys.argv[2]
    #
    # print(exp_check(url))
    # # exp_cmd(url,cmd)
